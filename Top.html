<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Zıplayan Top</title>

<style>
body{margin:0;background:#000;color:#fff;font-family:Arial;display:flex;justify-content:center;align-items:center;height:100vh}
#game{position:relative;width:100%;max-width:600px;height:320px;background:#000;overflow:hidden;border:2px solid #333}
#ball{position:absolute;width:18px;height:18px;border-radius:50%;background:#00ffd0;left:70px}
#ground{position:absolute;bottom:0;height:40px;width:100%;background:#222}
.star{position:absolute;background:#fff;border-radius:50%}
.obstacle{position:absolute;bottom:40px}
.vertical.low{background:#ff5555;width:18px;height:30px}
.vertical.high{background:#ff8844;width:22px;height:70px}
.top{background:#5599ff;width:22px;height:40px}
.platform{background:#55ff88;height:10px;border-radius:4px}
#score{position:absolute;top:10px;left:10px;font-size:18px}
#gameover{position:absolute;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;font-size:24px;text-align:center}
</style>
</head>

<body>

<div id="game">
  <div id="score">Skor: 0</div>
  <div id="ball"></div>
  <div id="ground"></div>
  <div id="gameover">Oyun Bitti<br>Tekrar başlamak için tıkla</div>
</div>

<script>
const game = document.getElementById("game");
const ball = document.getElementById("ball");
const scoreEl = document.getElementById("score");
const gameOverEl = document.getElementById("gameover");

let y = 80;
let vy = 0;
const gravity = 0.5;
const jumpPower = 9;
let jumps = 0; // çift zıplama sayacı

let speed = 3;
let frame = 0;
let score = 0;
let running = true;
const obstacles = [];
const stars = [];

function jump(){
  if(!running) return;
  if(jumps < 2){
    vy = jumpPower;
    jumps++;
  }
}
game.addEventListener("click", jump);
document.addEventListener("keydown", e=>{
  if(e.code==="Space") jump();
});

function loop(){
  if(!running) return;
  frame++;

  if(frame % 700 === 0) speed += 0.4;

  /* yıldızlar */
  if(frame % 15 === 0){
    const s=document.createElement("div");
    const size=Math.random()*2+1;
    s.className="star";
    s.style.width=size+"px";
    s.style.height=size+"px";
    s.style.right="-5px";
    s.style.top=Math.random()*200+"px";
    s.dataset.speed=Math.random()*0.5+0.2;
    game.appendChild(s);
    stars.push(s);
  }
  for(let i=stars.length-1;i>=0;i--){
    const s=stars[i];
    s.style.left=(s.offsetLeft-speed*s.dataset.speed)+"px";
    if(s.offsetLeft<-5){s.remove();stars.splice(i,1);}
  }

  /* fizik */
  vy -= gravity;
  y += vy;

  if(y <= 40){
    y = 40;
    vy = 0;
    jumps = 0; // yere değince zıplama sıfırlanır
  }

  /* engel üret */
  if(frame % 140 === 0){
    let o=document.createElement("div");
    let type=Math.random();
    if(type<0.4){
      o.className="obstacle vertical low";
    }else if(type<0.7){
      o.className="obstacle vertical high";
    }else if(type<0.9){
      o.className="obstacle top";
      o.style.bottom="140px";
    }else{
      o.className="obstacle platform";
      o.style.width="60px";
      o.style.bottom=(80+Math.random()*60)+"px";
    }
    o.style.right="-80px";
    game.appendChild(o);
    obstacles.push(o);
  }

  /* engeller */
  for(let i=obstacles.length-1;i>=0;i--){
    const o=obstacles[i];
    o.style.left=(o.offsetLeft-speed)+"px";

    const bx=70, bw=18, by=y, bh=18;
    const ox=o.offsetLeft, ow=o.offsetWidth;
    const oy=parseFloat(o.style.bottom), oh=o.offsetHeight;

    // platform üstünde durma
    if(o.classList.contains("platform")){
      if(
        bx+bw>ox && bx<ox+ow &&
        by <= oy+oh+5 && by >= oy+oh-10 &&
        vy<=0
      ){
        y = oy+oh;
        vy = 0;
        jumps = 0;
      }
    }else{
      // çarpışma
      if(
        bx < ox+ow && bx+bw > ox &&
        by < oy+oh && by+bh > oy
      ){
        endGame();
      }
    }

    if(ox<-100){
      o.remove();
      obstacles.splice(i,1);
      score++;
      scoreEl.textContent="Skor: "+score;
    }
  }

  ball.style.bottom=y+"px";
  requestAnimationFrame(loop);
}

function endGame(){
  running=false;
  gameOverEl.style.display="flex";
}
gameOverEl.onclick=()=>location.reload();

loop();
</script>

</body>
</html>
