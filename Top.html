<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Zıplayan Top</title>

<style>
body{margin:0;background:#000;color:#fff;font-family:Arial;display:flex;justify-content:center;align-items:center;height:100vh}
#game{position:relative;width:100%;max-width:600px;height:320px;background:#000;overflow:hidden;border:2px solid #333}
#ball{
  position:absolute;width:18px;height:18px;border-radius:50%;
  background:#00ffd0;left:70px;z-index:3;
  transform-origin:center bottom;
}
#ground{position:absolute;bottom:0;height:40px;width:100%;background:#222;z-index:2}
.star{position:absolute;background:#fff;border-radius:50%;opacity:.8}
.obstacle{position:absolute;z-index:3}
.vertical.low{background:#ff5555;width:18px;height:30px;bottom:40px}
.vertical.high{background:#ff8844;width:22px;height:70px;bottom:40px}
.top{background:#5599ff;width:22px;height:40px;top:40px}
.platform{background:#55ff88;height:10px;border-radius:4px}
.wide{background:#88ffcc;height:12px;border-radius:4px}
#score{position:absolute;top:10px;left:10px;font-size:18px;z-index:4}
#gameover{position:absolute;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;font-size:24px;text-align:center;z-index:5}
</style>
</head>

<body>
<div id="game">
  <div id="score">Skor: 0</div>
  <div id="ball"></div>
  <div id="ground"></div>
  <div id="gameover">Oyun Bitti<br>Tekrar başlamak için tıkla</div>
</div>

<script>
const game=document.getElementById("game");
const ball=document.getElementById("ball");
const scoreEl=document.getElementById("score");
const gameOverEl=document.getElementById("gameover");

let y=80, vy=0;
const gravity=0.5, jumpPower=9;
const idleBouncePower=1.2;
let jumps=0, playerJumping=false;

let frame=0, score=0, running=true;
const obstacles=[], stars=[];
const baseSpeed=3;
let obstacleTimer=0;

/* Zıplama */
function jump(){
  if(!running) return;
  if(jumps<2){
    vy=jumpPower;
    jumps++;
    playerJumping=true;
  }
}
game.addEventListener("click",jump);
document.addEventListener("keydown",e=>{if(e.code==="Space")jump();});

function loop(){
  if(!running) return;
  frame++;

  /* HIZ EĞRİSİ */
  let timeFactor=frame/600;
  let speed=baseSpeed+Math.pow(timeFactor,1.5);

  /* YILDIZ ARKA PLAN */
  if(frame%10===0){
    const s=document.createElement("div");
    const size=Math.random()*2+1;
    s.className="star";
    s.style.width=size+"px";
    s.style.height=size+"px";
    s.style.top=Math.random()*250+"px";
    s.style.right="-5px";
    s.dataset.speed=Math.random()*1+0.3;
    game.appendChild(s);
    stars.push(s);
  }
  for(let i=stars.length-1;i>=0;i--){
    const s=stars[i];
    s.style.left=(s.offsetLeft-speed*s.dataset.speed)+"px";
    if(s.offsetLeft<-10){s.remove();stars.splice(i,1);}
  }

  /* FİZİK */
  vy-=gravity;
  y+=vy;

  let squash=1, stretch=1;

  if(y<=40){
    y=40;
    jumps=0;
    if(playerJumping){vy=0;playerJumping=false;}
    else vy=idleBouncePower;
    squash=1.3; stretch=0.8;
  } else {stretch=1.1; squash=0.9;}

  ball.style.bottom=y+"px";
  ball.style.transform=`scale(${stretch},${squash})`;

  /* ENGEL SIKLIK EĞRİSİ */
  let spawnInterval=140-Math.min(70,Math.floor(frame/500));
  obstacleTimer++;

  if(obstacleTimer>=spawnInterval){
    obstacleTimer=0;
    let o=document.createElement("div");
    let type=Math.random();

    if(type<0.3)o.className="obstacle vertical low";
    else if(type<0.5)o.className="obstacle vertical high";
    else if(type<0.7)o.className="obstacle top";
    else if(type<0.85){
      o.className="obstacle platform";
      o.style.width="60px";
      o.style.bottom=(80+Math.random()*60)+"px";
    }else{
      o.className="obstacle wide";
      o.style.width="140px";
      o.style.bottom=(100+Math.random()*80)+"px";
    }

    o.style.right="-140px";
    game.appendChild(o);
    obstacles.push(o);
  }

  const ballRect=ball.getBoundingClientRect();

  for(let i=obstacles.length-1;i>=0;i--){
    const o=obstacles[i];
    o.style.left=(o.offsetLeft-speed)+"px";
    const rect=o.getBoundingClientRect();

    if(o.classList.contains("platform")||o.classList.contains("wide")){
      if(ballRect.right>rect.left &&
         ballRect.left<rect.right &&
         ballRect.bottom>=rect.top &&
         ballRect.bottom<=rect.top+6 &&
         vy<=0){
        y=rect.top-game.getBoundingClientRect().top-18;
        vy=0;
        jumps=0;
      }
    } else {
      if(ballRect.right>rect.left &&
         ballRect.left<rect.right &&
         ballRect.bottom>rect.top &&
         ballRect.top<rect.bottom){
        endGame();
      }
    }

    if(rect.right<0){
      o.remove();
      obstacles.splice(i,1);
      score++;
      scoreEl.textContent="Skor: "+score;
    }
  }

  requestAnimationFrame(loop);
}

function endGame(){
  running=false;
  gameOverEl.style.display="flex";
}
gameOverEl.onclick=()=>location.reload();

loop();
</script>
</body>
</html>
